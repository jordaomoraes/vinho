generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mongodb"
  url      = env("DATABASE_URL")
}
model Usuario {
  id       String    @id @default(cuid()) @map("_id")
  nome     String
  email    String
  senha    String
  tipo     Int?      @default(0)

  areas    Area[]    // Relação um-para-muitos com áreas
  culturas Cultura[] // Relação um-para-muitos com culturas
  plantacoes Plantacao[] // Relação um-para-muitos com plantações
  sensores Sensor[]   // Relação um-para-muitos com sensores
  leituras Leitura[]  // Relação um-para-muitos com leituras

  @@map("usuarios")
}


model Area {
  id         String    @id @default(cuid()) @map("_id")
  idUser     String
  tamanho    Float     @default(0)
  descricao  String
  latitude   String
  longitude  String

  usuario    Usuario   @relation(fields: [idUser], references: [id])
  plantacoes Plantacao[]
  sensores   Sensor[]

  @@map("areas")
}

model Cultura {
  id         String    @id @default(cuid()) @map("_id")
  idUser     String
  descricao  String

  usuario    Usuario   @relation(fields: [idUser], references: [id])
  plantacoes Plantacao[] // Relação um-para-muitos com plantações, usando `Type[]`

  @@map("culturas")
}

model Plantacao {
  id             String    @id @default(cuid()) @map("_id")
  idUser         String
  idArea         String?
  idCultura      String?
  dataPlantacao  DateTime?
  quantidade     Float     @default(0)

  usuario        Usuario   @relation(fields: [idUser], references: [id])
  area           Area?     @relation(fields: [idArea], references: [id])
  cultura        Cultura?  @relation(fields: [idCultura], references: [id])

  @@map("plantacoes")
}


model Sensor {
  id            String    @id @default(cuid()) @map("_id")
  idUser        String
  idArea        String?
  latitude      String
  longitude     String
  descricao     String
  tipo          String
  dataInstalacao DateTime?

  usuario       Usuario   @relation(fields: [idUser], references: [id])
  area          Area?     @relation(fields: [idArea], references: [id])
  leituras      Leitura[] // Relação um-para-muitos com leituras, usando `Type[]`

  @@map("sensores")
}


model Leitura {
  id            String    @id @default(cuid()) @map("_id")
  idUser        String
  idSensor      String
  umidadeMedida Float     @default(0)
  dataMedicao   DateTime  @default(now())

  usuario       Usuario   @relation(fields: [idUser], references: [id])
  sensor        Sensor    @relation(fields: [idSensor], references: [id])

  @@map("leituras")
}
